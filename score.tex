%
% Typeset by Reuben Thomas 24th February 2022
%

\documentclass{scrbook}
\usepackage[pagestyleset=standard]{scrlayer-scrpage}
\usepackage{fontspec,url,microtype}
\usepackage[british]{babel}
\usepackage{gitinfo2,xparse,graphicx,circledsteps,mathtools}


% Alter some default parameters for general typesetting

\pagestyle{scrheadings}
\setmainfont{TeX Gyre Pagella}
\setsansfont{Lato}
\frenchspacing
\raggedbottom

% Avoid widows and orphans
% https://mailman.ntg.nl/pipermail/ntg-context/2013/074250.html
\widowpenalty 10000
\clubpenalty 10000

% New commands
\catcode`'=\active
\def'{\textbf{~·}}
\catcode`|=\active
\def|{\textbf{~\textbar}}
\catcode`‖=\active
\def‖{\textbf{~\textbar\textbar}}
\newcommand{\onlyscore}[1]{#1}
\newcommand{\halfone}{\item[\Circled{1}]}
\newcommand{\halftwo}{\item[\Circled{3}]}
\newcommand{\quartertwo}{\item[\Circled{2}]}
\newcommand{\quarterfour}{\item[\Circled{4}]}
\newcommand{\nochant}{\item[\Circled{!}]}
\newcommand{\scorepagebreak}{\pagebreak}
\newcommand{\chantnobreak}[1]{\noindent\includegraphics[scale=0.8]{#1}\par}
\newcommand{\chant}[1]{\pagebreak\chantnobreak{#1}}
\newcommand{\musicnote}[1]{\textsuperscript{*}\marginpar{#1}}
\newcommand{\overword}[2]{$\stackrel{#1}{\textrm{#2}}$}
\newcommand{\sharpword}[1]{\overword{♯}{#1}}
\newcommand{\naturalword}[1]{\overword{♮}{#1}}
\newcommand{\flatword}[1]{\overword{♭}{#1}}

\begin{document}

\frontmatter
\date{Git commit \gitFirstTagDescribe}
\author{Story by J.\,R.\,R. Tolkien \and Music composed and adapted by Laurence Fischer \and Word setting by Reuben Thomas}
\input{title.tex}
\cleardoublepage

\mainmatter
\input{niggle.tex}

\end{document}
